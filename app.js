var check = 'data:image/png;base64,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';
var logo = 'data:image/png;base64,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';

var data = {
  company: 'company name'.toUpperCase(),
  address: '420 Street, Number, CityName City',
  date: '10-Oct-2020',
  // date: $filter('date')(new Date(), 'dd-MMM-yyyy'),
  reference_number: '123456789',
  name: 'name',
  employee_number: 'employee_number',
  job_title: 'job_title',
  date_hired: 'date_hired',
  statuses: ['Hiring', 'Transfer', 'Retirement', 'Salary Adjustment', 'Promotion', 'Resignation', 'End of Contract', 'Others', 'Regularization', 'Termination'],
  action_reference: 'action_reference',
  remarks: 'remarks',
  prepared_by: {
    name_over_signature: '',
    department: '',
    date: ''
  },
  approved_by: {
    name_over_signature: '',
    department: '',
    date: ''
  },
  employee_acknowledgement: {
    employee_name_over_signature: '',
    date: ''
  },
};

var options = {
  orientation: 'portrait',
  // orientation: 'landscape',
  unit: 'mm', // used in values ex: var paperHeightTenth = paperHeight / 10(mm);
  format: 'letter' //[4(length?), 2(height?)]
};

var doc = new jsPDF(options);
console.log(doc);

var pageSize = doc.internal.pageSize;

var docHeightRate = pageSize.height / 100;
var docWidthRate = pageSize.width / 100;

//set form box properties
var formMarginLeft = docWidthRate / 15 * 100;
var formMarginTop = docHeightRate / 15 * 100;
var formWidth = docWidthRate * 87;
var formHeight = docHeightRate * 70;

// draw form box
doc.rect(formMarginLeft, formMarginTop, formWidth, formHeight);

var boxesProperties = [
  {height: 20, horizontals: [45, 60, 85, 100], verticals: [50], verticalMarginTop: 45},
  {height: 12, horizontals: [0, 33, 66], verticals: [5, 25, 30, 50, 55, 75, 80], verticalMarginTop: 0},
  {height: 14, horizontals: [25], verticals: [], verticalMarginTop: 0},
  {height: 14, horizontals: [25], verticals: [], verticalMarginTop: 0},
  {height: 14, horizontals: [25, 75], verticals: [40, 80], verticalMarginTop: 25},
  {height: 12, horizontals: [25, 75], verticals: [40, 80], verticalMarginTop: 25},
  {height: 14, horizontals: [25, 75], verticals: [40, 80], verticalMarginTop: 25}
];
var statuses = [];

var boxMarginLeft = formMarginLeft + 1.5;
var boxWidth = formWidth - 3;

var boxHeightRate = formHeight / 100;
var addMarginTop = formMarginTop + 1.5;

// rect width != hor line width
var horizontalWidth = boxMarginLeft + boxWidth;

function createLayout(){
  // loop boxes then draw rect each
  boxesProperties.forEach(function(box, boxIndex, boxesArray){
    var spaceBetween = boxIndex == 2 || boxIndex == (boxesArray.length - 1) ? 3 : 1.5;
    var boxHeight = boxHeightRate * box.height - spaceBetween;
    var boxMarginTop = addMarginTop;

    // draw each box
    doc.rect(boxMarginLeft, boxMarginTop, boxWidth, boxHeight);
    addMarginTop += boxHeight + spaceBetween;

    var horizontalRate = boxHeight / 100;
    var verticalRate = boxWidth / 100;

    // draw company name & logo
    if (boxIndex == 0) {
      doc.setFontSize(15);
      var textWidth = doc.getTextWidth(data.company);
      var centerText = formMarginLeft + ((formWidth - textWidth) / 2);
      var textHeight = doc.getTextDimensions(data.company).h;
      doc.text(data.company, centerText, boxMarginTop + textHeight);

      doc.setFontSize(10);
      textWidth = doc.getTextWidth(data.address);
      centerText = formMarginLeft + ((formWidth - textWidth) / 2);
      textHeight = textHeight + doc.getTextDimensions(data.address).h;
      doc.text(data.address, centerText, boxMarginTop + textHeight);

      var logoMarginLeft = formMarginLeft + (verticalRate * 88);
      var logoMarginTop = formMarginTop + (horizontalRate * 11);
      doc.addImage(logo, 'png', logoMarginLeft, logoMarginTop, 15, 10);
      
      logoMarginLeft = formMarginLeft + (verticalRate * 5);
      logoMarginTop = formMarginTop + (horizontalRate * 11);
      doc.addImage(logo, 'png', logoMarginLeft, logoMarginTop, 15, 10);
    }

    // draw a horizontal line under box 3
    if (boxIndex == 3) {
      var lineMarginTop = boxMarginTop - 1.5;
      doc.line(boxMarginLeft, lineMarginTop, horizontalWidth, lineMarginTop);
      
    }

    // loop lines then draw each
    box.horizontals.forEach(function(lineWidth, lineWidthIndex, horizontalsArray){
      var horizontalMarginTop = boxMarginTop + (horizontalRate * lineWidth);

      // draw horizontal line
      if (lineWidth > 0 && lineWidth < 100){
        doc.line(boxMarginLeft, horizontalMarginTop, horizontalWidth, horizontalMarginTop);
      }

      if (boxIndex == 0 && lineWidthIndex == 0) {
        doc.setFontSize(9);
        var textHeight = doc.getTextDimensions(data.date).h;
        // textHeight = horizontalRate * textHeight;
        
        var marginTopStart = horizontalMarginTop;
        var marginTopEnd = boxMarginTop + (horizontalRate * horizontalsArray[lineWidthIndex + 1]);
        var marginTop = horizontalMarginTop + textHeight;
        // var marginTop = horizontalMarginTop + ((marginTopEnd - marginTopStart) / 2);

        console.log(marginTopEnd);
        console.log(marginTopStart);
        console.log(marginTop);
        console.log(textHeight);
        
        doc.text('Date: ' + data.date, boxMarginLeft + 2, marginTop);
        // doc.line(boxMarginLeft, 39.87, horizontalWidth, 39.87);
      }

      box.verticals.forEach(function(lineMarginLeft, lineMarginLeftIndex, verticalsArray){
        var verticalMarginLeft = boxMarginLeft + (verticalRate * lineMarginLeft);

        if (lineWidthIndex == 0) {
          var verticalStart = boxMarginTop + (horizontalRate * box.verticalMarginTop);
          var verticalEnd = boxMarginTop + boxHeight;

          // draw vertical line
          doc.line(verticalMarginLeft, verticalStart, verticalMarginLeft, verticalEnd);
        }

        // draw checkboxes
        if (boxIndex == 1 && lineMarginLeftIndex % 2 == 0) {
          var checkboxSizeIncrease = boxHeight / 15;
          var checkboxSize = verticalRate * checkboxSizeIncrease;

          var totalCheckboxLeftSpace = boxesProperties[1].verticals[0];
          var marginLeftSpace = verticalRate * ((totalCheckboxLeftSpace + checkboxSizeIncrease) / 2);
          var adjustMarginLeft = verticalMarginLeft - marginLeftSpace;

          var totalCheckboxCellSpace = boxHeight / 3;
          var marginTopSpace = (totalCheckboxCellSpace - checkboxSize) / 2;
          var adjustMarginTop = horizontalMarginTop + marginTopSpace;

          // draw checkbox
          var maxMarginTop = boxMarginTop + (horizontalRate * horizontalsArray[2]);
          var maxMarginLeft = boxMarginLeft + (verticalRate * verticalsArray[3]);

          if (adjustMarginLeft < maxMarginLeft || adjustMarginTop < maxMarginTop) {
            doc.rect(adjustMarginLeft, adjustMarginTop, checkboxSize, checkboxSize);
            statuses.push({marginLeft: verticalMarginLeft + 1.5, marginTop: adjustMarginTop + 2});
          }

        }
      });

    });

  });

  statuses.forEach(function(checkbox, checkboxIndex){
    // fix setFontSize, dynamic adjust to portrait/landscape
    doc.setFontSize(8);
    doc.text(data.statuses[checkboxIndex], checkbox.marginLeft, checkbox.marginTop);
  });
  return doc;
}

function openPDF() {
  var createdPDFFile = createLayout();
  // window.open(createdPDFFile.output('bloburl'));
  doc.output('dataurlnewwindow');
}
openPDF();

function printPDF() {
  var createdPDFFile = createLayout();
  createdPDFFile.autoPrint();
  window.open(createdPDFFile.output('bloburl'));
}

function downloadPDF(filename) {
  var createdPDFFile = createLayout();
  filename = filename + '.pdf';
  // createdPDFFile.save(filename);
}

function toTitleCase(str) {
  return str.replace(/\w\S*/g, function(text){
    return text.charAt(0).toUpperCase() + text.substr(1).toLowerCase();
  })
}
